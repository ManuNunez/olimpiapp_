const u="http://127.0.0.1:8000/api";async function s(e,t={}){const c=`${u}${e}`,n={headers:{"Content-Type":"application/json",Accept:"application/json",...t.headers},...t},r=localStorage.getItem("auth_token");r&&(n.headers.Authorization=`Bearer ${r}`);try{const o=await fetch(c,n);if(!o.ok){const i=await o.json();throw new Error(`HTTP error! status: ${o.status}`,{cause:i})}return await o.json()}catch(o){throw console.error("API request failed:",o),o}}function g(e){return s(e,{method:"GET"})}function a(e,t={}){return s(e,{method:"POST",body:JSON.stringify(t)})}const l={login:async e=>{const t=await a("/login",e);return t.access_token&&localStorage.setItem("auth_token",t.access_token),t},register:async e=>{const t=await a("/register",e);return t.access_token&&localStorage.setItem("auth_token",t.access_token),t},logout:async()=>{await a("/logout"),localStorage.removeItem("auth_token")},isLoggedIn:()=>!!localStorage.getItem("auth_token"),getToken:()=>localStorage.getItem("auth_token"),me:async()=>await g("/me")};export{l as a};
