import{a1 as k,a2 as m,a3 as f,a4 as g,u as d,a5 as y,a as h,a6 as w,e as I}from"./C2U4IKIp.js";function v(e=!1){const t=k,a=t.l.u;if(!a)return;let s=()=>w(t.s);if(e){let n=0,o={};const c=I(()=>{let l=!1;const i=t.s;for(const r in i)i[r]!==o[r]&&(o[r]=i[r],l=!0);return l&&n++,n});s=()=>h(c)}a.b.length&&m(()=>{p(t,s),g(a.b)}),f(()=>{const n=d(()=>a.m.map(y));return()=>{for(const o of n)typeof o=="function"&&o()}}),a.a.length&&f(()=>{p(t,s),g(a.a)})}function p(e,t){if(e.l.s)for(const a of e.l.s)h(a);t()}const S="http://127.0.0.1:8000/api";async function _(e,t={}){const a=`${S}${e}`,s={headers:{"Content-Type":"application/json",Accept:"application/json",...t.headers},...t},n=localStorage.getItem("auth_token");n&&(s.headers.Authorization=`Bearer ${n}`);try{const o=await fetch(a,s);if(!o.ok){const c=await o.json();throw new Error(`HTTP error! status: ${o.status}`,{cause:c})}return await o.json()}catch(o){throw console.error("API request failed:",o),o}}function T(e){return _(e,{method:"GET"})}function u(e,t={}){return _(e,{method:"POST",body:JSON.stringify(t)})}const A={login:async e=>{const t=await u("/login",e);return t.access_token&&localStorage.setItem("auth_token",t.access_token),t},register:async e=>{const t=await u("/register",e);return t.access_token&&localStorage.setItem("auth_token",t.access_token),t},logout:async()=>{await u("/logout"),localStorage.removeItem("auth_token")},isLoggedIn:()=>!!localStorage.getItem("auth_token"),getToken:()=>localStorage.getItem("auth_token"),me:async()=>await T("/me")};export{A as a,v as i};
