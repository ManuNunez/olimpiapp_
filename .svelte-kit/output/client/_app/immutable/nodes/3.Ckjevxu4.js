import"../chunks/CWj6FrbW.js";import"../chunks/BUd4d-LD.js";import{o as ue}from"../chunks/elrBWB1X.js";import{R as me,t as n,w as v,T as be,$ as pe,F as i,W as h,B as e,x as a,V as s,y as t,v as M,ao as X,G as Y}from"../chunks/CrvXbrvd.js";import{e as F,s as y}from"../chunks/Dcj7EJXu.js";import{i as x}from"../chunks/CuKpEqi_.js";import{h as fe}from"../chunks/B-D_S5cw.js";import{i as ge,r as Z}from"../chunks/1xChGMt5.js";import{b as $}from"../chunks/B1UZVbEk.js";import{a as R}from"../chunks/DcXcS57e.js";import{g as _e}from"../chunks/Dv3kE98R.js";function qe(E){return function(...P){var l=P[0];return l.preventDefault(),E==null?void 0:E.apply(this,P)}}var he=n('<div class="loading-container svelte-d6bq0g"><div class="loading-spinner svelte-d6bq0g"></div> <p class="svelte-d6bq0g">Cargando información del usuario...</p></div>'),ye=n('<div class="error-container svelte-d6bq0g"><div class="error-message svelte-d6bq0g"><h3 class="svelte-d6bq0g">Error</h3> <p class="svelte-d6bq0g"> </p> <button class="retry-btn svelte-d6bq0g">Reintentar</button></div></div>'),xe=n('<form class="edit-form svelte-d6bq0g"><div class="form-group svelte-d6bq0g"><label for="name" class="svelte-d6bq0g">Nombre:</label> <input id="name" type="text" placeholder="Tu nombre completo" required class="svelte-d6bq0g"/></div> <div class="form-group svelte-d6bq0g"><label for="email" class="svelte-d6bq0g">Email:</label> <input id="email" type="email" placeholder="tu@email.com" required class="svelte-d6bq0g"/></div> <div class="form-actions svelte-d6bq0g"><button type="submit" class="save-btn svelte-d6bq0g"> </button> <button type="button" class="cancel-btn svelte-d6bq0g">Cancelar</button></div></form>'),Ee=n('<div class="info-item svelte-d6bq0g"><label class="svelte-d6bq0g">Miembro desde:</label> <span class="svelte-d6bq0g"> </span></div>'),we=n('<div class="info-item svelte-d6bq0g"><label class="svelte-d6bq0g">Última actualización:</label> <span class="svelte-d6bq0g"> </span></div>'),Ce=n('<div class="profile-info svelte-d6bq0g"><div class="info-item svelte-d6bq0g"><label class="svelte-d6bq0g">Nombre:</label> <span class="svelte-d6bq0g"> </span></div> <div class="info-item svelte-d6bq0g"><label class="svelte-d6bq0g">Email:</label> <span class="svelte-d6bq0g"> </span></div> <!> <!></div>'),De=n('<div class="user-profile svelte-d6bq0g"><div class="profile-card svelte-d6bq0g"><div class="card-header svelte-d6bq0g"><h2 class="svelte-d6bq0g">Información Personal</h2></div> <!></div></div>'),ke=n('<div class="account-container svelte-d6bq0g"><div class="account-header svelte-d6bq0g"><h1 class="svelte-d6bq0g">Mi Cuenta</h1> <button class="logout-btn svelte-d6bq0g">Cerrar Sesión</button></div> <!></div>');function Re(E,P){me(P,!1);let l=h(null),T=h(!0),p=h(null),w=h(!1),B=h(!1),o=h({name:"",email:""});ue(async()=>{{if(!R.isLoggedIn()){_e("/login");return}await J()}});async function J(){try{i(T,!0),i(p,null),i(l,await R.me()),i(o,{name:e(l).name||"",email:e(l).email||""})}catch(r){console.error("Error cargando datos del usuario:",r),i(p,"No se pudieron cargar los datos del usuario"),(r.message.includes("401")||r.message.includes("Unauthorized"))&&K()}finally{i(T,!1)}}async function K(){try{await R.logout()}catch(r){console.error("Error en logout:",r)}finally{localStorage.removeItem("auth_token"),window.location.href="/"}}function ee(){i(B,!1),i(o,{name:e(l).name||"",email:e(l).email||""})}async function ae(){try{i(w,!0),i(p,null);const r=await R.updateProfile(e(o));i(l,r),i(B,!1),alert("Perfil actualizado correctamente")}catch(r){console.error("Error actualizando perfil:",r),i(p,"Error al actualizar el perfil")}finally{i(w,!1)}}function Q(r){return r?new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}ge();var O=ke();fe(r=>{pe.title="Mi Cuenta - OlimpiApp"});var V=a(O),te=s(a(V),2);t(V);var re=s(V,2);{var se=r=>{var W=he();v(r,W)},le=(r,W)=>{{var ie=f=>{var C=ye(),G=a(C),c=s(a(G),2),D=a(c,!0);t(c);var I=s(c,2);t(G),t(C),M(()=>y(D,e(p))),F("click",I,J),v(f,C)},oe=(f,C)=>{{var G=c=>{var D=De(),I=a(D),de=s(a(I),2);{var ve=g=>{var d=xe(),u=a(d),k=s(a(u),2);Z(k),t(u);var z=s(u,2),_=s(a(z),2);Z(_),t(z);var N=s(z,2),q=a(N),S=a(q,!0);t(q);var A=s(q,2);t(N),t(d),M(()=>{q.disabled=e(w),y(S,e(w)?"Guardando...":"Guardar Cambios"),A.disabled=e(w)}),$(k,()=>e(o).name,U=>X(o,e(o).name=U)),$(_,()=>e(o).email,U=>X(o,e(o).email=U)),F("click",A,ee),F("submit",d,qe(ae)),v(g,d)},ne=g=>{var d=Ce(),u=a(d),k=s(a(u),2),z=a(k,!0);t(k),t(u);var _=s(u,2),N=s(a(_),2),q=a(N,!0);t(N),t(_);var S=s(_,2);{var A=m=>{var b=Ee(),L=s(a(b),2),j=a(L,!0);t(L),t(b),M(H=>y(j,H),[()=>Q(e(l).created_at)],Y),v(m,b)};x(S,m=>{e(l).created_at&&m(A)})}var U=s(S,2);{var ce=m=>{var b=we(),L=s(a(b),2),j=a(L,!0);t(L),t(b),M(H=>y(j,H),[()=>Q(e(l).updated_at)],Y),v(m,b)};x(U,m=>{e(l).updated_at&&m(ce)})}t(d),M(()=>{y(z,e(l).name||"No especificado"),y(q,e(l).email)}),v(g,d)};x(de,g=>{e(B)?g(ve):g(ne,!1)})}t(I),t(D),v(c,D)};x(f,c=>{e(l)&&c(G)},C)}};x(r,f=>{e(p)?f(ie):f(oe,!1)},W)}};x(re,r=>{e(T)?r(se):r(le,!1)})}t(O),F("click",te,K),v(E,O),be()}export{Re as component};
