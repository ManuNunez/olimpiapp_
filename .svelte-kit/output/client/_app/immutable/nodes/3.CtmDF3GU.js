import"../chunks/CWj6FrbW.js";import"../chunks/BGmNO-Kf.js";import{o as me}from"../chunks/CTLqXXGx.js";import{am as be,W as n,Y as v,an as pe,$ as fe,s as i,m as h,a as e,Z as a,ao as s,_ as t,X as M,ap as K,d as Q}from"../chunks/C2U4IKIp.js";import{e as F,s as y}from"../chunks/B6thhSHX.js";import{i as E}from"../chunks/ly8UQ4rw.js";import{h as ge}from"../chunks/BjGg-ub7.js";import{r as V}from"../chunks/IJEFhr2z.js";import{b as $}from"../chunks/Ca9TkKAE.js";import{i as _e,a as O}from"../chunks/CPKMhm4T.js";import{g as ee}from"../chunks/BMpYDMX-.js";function qe(x){return function(...P){var l=P[0];return l.preventDefault(),x==null?void 0:x.apply(this,P)}}var he=n('<div class="loading-container svelte-d6bq0g"><div class="loading-spinner svelte-d6bq0g"></div> <p class="svelte-d6bq0g">Cargando información del usuario...</p></div>'),ye=n('<div class="error-container svelte-d6bq0g"><div class="error-message svelte-d6bq0g"><h3 class="svelte-d6bq0g">Error</h3> <p class="svelte-d6bq0g"> </p> <button class="retry-btn svelte-d6bq0g">Reintentar</button></div></div>'),Ee=n('<form class="edit-form svelte-d6bq0g"><div class="form-group svelte-d6bq0g"><label for="name" class="svelte-d6bq0g">Nombre:</label> <input id="name" type="text" placeholder="Tu nombre completo" required class="svelte-d6bq0g"/></div> <div class="form-group svelte-d6bq0g"><label for="email" class="svelte-d6bq0g">Email:</label> <input id="email" type="email" placeholder="tu@email.com" required class="svelte-d6bq0g"/></div> <div class="form-actions svelte-d6bq0g"><button type="submit" class="save-btn svelte-d6bq0g"> </button> <button type="button" class="cancel-btn svelte-d6bq0g">Cancelar</button></div></form>'),xe=n('<div class="info-item svelte-d6bq0g"><label class="svelte-d6bq0g">Miembro desde:</label> <span class="svelte-d6bq0g"> </span></div>'),Ce=n('<div class="info-item svelte-d6bq0g"><label class="svelte-d6bq0g">Última actualización:</label> <span class="svelte-d6bq0g"> </span></div>'),De=n('<div class="profile-info svelte-d6bq0g"><div class="info-item svelte-d6bq0g"><label class="svelte-d6bq0g">Nombre:</label> <span class="svelte-d6bq0g"> </span></div> <div class="info-item svelte-d6bq0g"><label class="svelte-d6bq0g">Email:</label> <span class="svelte-d6bq0g"> </span></div> <!> <!></div>'),ke=n('<div class="user-profile svelte-d6bq0g"><div class="profile-card svelte-d6bq0g"><div class="card-header svelte-d6bq0g"><h2 class="svelte-d6bq0g">Información Personal</h2></div> <!></div></div>'),we=n('<div class="account-container svelte-d6bq0g"><div class="account-header svelte-d6bq0g"><h1 class="svelte-d6bq0g">Mi Cuenta</h1> <button class="logout-btn svelte-d6bq0g">Cerrar Sesión</button></div> <!></div>');function Oe(x,P){be(P,!1);let l=h(null),R=h(!0),p=h(null),C=h(!1),T=h(!1),o=h({name:"",email:""});me(async()=>{{if(!O.isLoggedIn()){ee("/login");return}await B()}});async function B(){try{i(R,!0),i(p,null),i(l,await O.me()),i(o,{name:e(l).name||"",email:e(l).email||""})}catch(r){console.error("Error cargando datos del usuario:",r),i(p,"No se pudieron cargar los datos del usuario"),(r.message.includes("401")||r.message.includes("Unauthorized"))&&H()}finally{i(R,!1)}}async function H(){try{await O.logout()}catch(r){console.error("Error en logout:",r)}finally{localStorage.removeItem("auth_token"),ee("/login")}}function ae(){i(T,!1),i(o,{name:e(l).name||"",email:e(l).email||""})}async function te(){try{i(C,!0),i(p,null);const r=await O.updateProfile(e(o));i(l,r),i(T,!1),alert("Perfil actualizado correctamente")}catch(r){console.error("Error actualizando perfil:",r),i(p,"Error al actualizar el perfil")}finally{i(C,!1)}}function J(r){return r?new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}_e();var W=we();ge(r=>{fe.title="Mi Cuenta - OlimpiApp"});var X=a(W),re=s(a(X),2);t(X);var se=s(X,2);{var le=r=>{var Y=he();v(r,Y)},ie=(r,Y)=>{{var oe=f=>{var D=ye(),I=a(D),c=s(a(I),2),k=a(c,!0);t(c);var S=s(c,2);t(I),t(D),M(()=>y(k,e(p))),F("click",S,B),v(f,D)},de=(f,D)=>{{var I=c=>{var k=ke(),S=a(k),ve=s(a(S),2);{var ne=g=>{var d=Ee(),u=a(d),w=s(a(u),2);V(w),t(u);var z=s(u,2),_=s(a(z),2);V(_),t(z);var N=s(z,2),q=a(N),A=a(q,!0);t(q);var G=s(q,2);t(N),t(d),M(()=>{q.disabled=e(C),y(A,e(C)?"Guardando...":"Guardar Cambios"),G.disabled=e(C)}),$(w,()=>e(o).name,U=>K(o,e(o).name=U)),$(_,()=>e(o).email,U=>K(o,e(o).email=U)),F("click",G,ae),F("submit",d,qe(te)),v(g,d)},ce=g=>{var d=De(),u=a(d),w=s(a(u),2),z=a(w,!0);t(w),t(u);var _=s(u,2),N=s(a(_),2),q=a(N,!0);t(N),t(_);var A=s(_,2);{var G=m=>{var b=xe(),L=s(a(b),2),Z=a(L,!0);t(L),t(b),M(j=>y(Z,j),[()=>J(e(l).created_at)],Q),v(m,b)};E(A,m=>{e(l).created_at&&m(G)})}var U=s(A,2);{var ue=m=>{var b=Ce(),L=s(a(b),2),Z=a(L,!0);t(L),t(b),M(j=>y(Z,j),[()=>J(e(l).updated_at)],Q),v(m,b)};E(U,m=>{e(l).updated_at&&m(ue)})}t(d),M(()=>{y(z,e(l).name||"No especificado"),y(q,e(l).email)}),v(g,d)};E(ve,g=>{e(T)?g(ne):g(ce,!1)})}t(S),t(k),v(c,k)};E(f,c=>{e(l)&&c(I)},D)}};E(r,f=>{e(p)?f(oe):f(de,!1)},Y)}};E(se,r=>{e(R)?r(le):r(ie,!1)})}t(W),F("click",re,H),v(x,W),pe()}export{Oe as component};
